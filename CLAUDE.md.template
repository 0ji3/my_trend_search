# CLAUDE.md - eBay ãƒˆãƒ¬ãƒ³ãƒ‰ãƒªã‚µãƒ¼ãƒãƒ„ãƒ¼ãƒ« é–‹ç™ºã‚¬ã‚¤ãƒ‰

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã€Claude Codeã§ã®é–‹ç™ºã‚’å††æ»‘ã«é€²ã‚ã‚‹ãŸã‚ã®é–‹ç™ºã‚¬ã‚¤ãƒ‰ã§ã™ã€‚

---

## ğŸ“‹ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå
**eBay ã‚«ã‚¹ã‚¿ãƒ ãƒˆãƒ¬ãƒ³ãƒ‰ãƒªã‚µãƒ¼ãƒãƒ„ãƒ¼ãƒ«**

### ç›®çš„
eBayå‡ºå“è€…ãŒè‡ªèº«ã®å•†å“ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ã—ã€Viewæ•°ã‚„Watchæ•°ãŒæ€¥æˆé•·ã—ã¦ã„ã‚‹å•†å“ï¼ˆãƒˆãƒ¬ãƒ³ãƒ‰å•†å“ï¼‰ã‚’è‡ªå‹•æ¤œå‡ºã™ã‚‹ã“ã¨ã§ã€é–¢é€£å•†å“ã®å‡ºå“æˆ¦ç•¥ã‚’æœ€é©åŒ–ã™ã‚‹ãƒ„ãƒ¼ãƒ«ã€‚

### ä¸»è¦æ©Ÿèƒ½
1. **ãƒãƒ«ãƒã‚¢ã‚«ã‚¦ãƒ³ãƒˆå¯¾å¿œ**: è¤‡æ•°ã®eBayã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä¸€å…ƒç®¡ç†
2. **è‡ªå‹•ãƒ‡ãƒ¼ã‚¿åé›†**: 1æ—¥1å›ã€å…¨å‡ºå“ç‰©ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’è‡ªå‹•å–å¾—ï¼ˆ2,000ä»¶/ã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼‰
3. **ãƒˆãƒ¬ãƒ³ãƒ‰åˆ†æ**: Viewæ•°ãƒ»Watchæ•°ã®æˆé•·ç‡ã‚’åˆ†æã—ã€TOP10ã‚’è‡ªå‹•æŠ½å‡º
4. **ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰**: ãƒˆãƒ¬ãƒ³ãƒ‰å•†å“ã®å¯è¦–åŒ–ã¨ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¨ç§»è¡¨ç¤º
5. **Analyticsçµ±åˆ**: CTRã€Impressionã€Conversion Rateã®è©³ç´°åˆ†æ
6. **Feed API**: åˆå›åŒæœŸæ™‚ã®é«˜é€Ÿãƒãƒ«ã‚¯ãƒ‡ãƒ¼ã‚¿å–å¾—

---

## ğŸ“ å®Ÿè£…çŠ¶æ³

### âœ… Phase 1-8: å®Œäº†

ã™ã¹ã¦ã®ä¸»è¦æ©Ÿèƒ½ãŒå®Ÿè£…ã•ã‚Œã€å®Ÿéš›ã®eBay APIã¨æ¥ç¶šå¯èƒ½ãªçŠ¶æ…‹ã§ã™ã€‚

#### Phase 1: åŸºç›¤æ§‹ç¯‰
- Dockerç’°å¢ƒï¼ˆPostgreSQL 16, Redis 7, FastAPI, React 18, Celeryï¼‰
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆã¨ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ ã®æ§‹ç¯‰

#### Phase 2: èªè¨¼ã‚·ã‚¹ãƒ†ãƒ 
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²ãƒ»ãƒ­ã‚°ã‚¤ãƒ³ï¼ˆJWTã€bcryptï¼‰
- ãƒˆãƒ¼ã‚¯ãƒ³è‡ªå‹•ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥
- ReduxçŠ¶æ…‹ç®¡ç†

#### Phase 3: eBay OAuthé€£æº
- OAuth 2.0ãƒ•ãƒ­ãƒ¼å®Ÿè£…
- ãƒˆãƒ¼ã‚¯ãƒ³æš—å·åŒ–ï¼ˆAES-256-GCMï¼‰
- ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæ¥ç¶šãƒ»åˆ‡æ–­æ©Ÿèƒ½

#### Phase 4: ãƒ‡ãƒ¼ã‚¿åŒæœŸ
- Trading APIçµ±åˆï¼ˆView/Watchæ•°å–å¾—ï¼‰
- Listingãƒ»DailyMetricãƒ¢ãƒ‡ãƒ«
- Celeryãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã‚¿ã‚¹ã‚¯
- **ãƒ¢ãƒƒã‚¯ãƒ¢ãƒ¼ãƒ‰å®Ÿè£…**

#### Phase 5: ãƒˆãƒ¬ãƒ³ãƒ‰åˆ†æ
- TrendAnalysisãƒ¢ãƒ‡ãƒ«
- ãƒˆãƒ¬ãƒ³ãƒ‰ã‚¹ã‚³ã‚¢è¨ˆç®—ï¼ˆViewæˆé•·ç‡Ã—0.4 + Watchæˆé•·ç‡Ã—0.4 + ä¾¡æ ¼å‹¢ã„Ã—0.2ï¼‰
- TOP10è‡ªå‹•æŠ½å‡º
- 7æ—¥é–“ç§»å‹•å¹³å‡ç®—å‡º

#### Phase 6: ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰å¼·åŒ–
- KPIãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ï¼ˆå®Ÿãƒ‡ãƒ¼ã‚¿æ¥ç¶šï¼‰
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚°ãƒ©ãƒ•ï¼ˆRechartsï¼‰
- ãƒˆãƒ¬ãƒ³ãƒ‰TOP10ãƒªã‚¹ãƒˆè¡¨ç¤º

#### Phase 7: Analytics & Feed APIçµ±åˆ
- Analytics APIï¼ˆCTRã€Impressionã€Conversion Rateï¼‰
- Feed APIï¼ˆãƒãƒ«ã‚¯åŒæœŸã€åˆå›åŒæœŸé«˜é€ŸåŒ–ï¼‰
- AnalyticsMetricãƒ¢ãƒ‡ãƒ«

#### Phase 8: ãƒãƒ«ãƒã‚¢ã‚«ã‚¦ãƒ³ãƒˆå¯¾å¿œï¼ˆå®Œäº†ï¼ï¼‰
- âœ… **è¤‡æ•°eBayã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ä¸€å…ƒç®¡ç†**
- âœ… **ã‚¢ã‚«ã‚¦ãƒ³ãƒˆåˆ‡ã‚Šæ›¿ãˆã‚¿ãƒ–UIï¼ˆMaterial-UIï¼‰**
- âœ… **ã‚¢ã‚«ã‚¦ãƒ³ãƒˆåˆ¥ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°**
- âœ… **é‡è¤‡ã‚¢ã‚«ã‚¦ãƒ³ãƒˆé˜²æ­¢æ©Ÿèƒ½**
- âœ… **OAuth 2.0ãƒãƒ«ãƒã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ•ãƒ­ãƒ¼**

---

## ğŸ”„ è‡ªå‹•ãƒãƒƒãƒã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«

Celery Beatã«ã‚ˆã‚‹è‡ªå‹•å®Ÿè¡Œã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«:

```
02:00 UTC â†’ Trading API ãƒ‡ãƒ¼ã‚¿åŒæœŸï¼ˆView/Watchæ•°ï¼‰
02:30 UTC â†’ Analytics API åŒæœŸï¼ˆCTR/Impression/Conversionï¼‰
03:00 UTC â†’ ãƒˆãƒ¬ãƒ³ãƒ‰åˆ†æï¼ˆæˆé•·ç‡è¨ˆç®—ã€TOP10æŠ½å‡ºï¼‰
æ¯æ™‚      â†’ OAuth ãƒˆãƒ¼ã‚¯ãƒ³ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥
```

**æ‰‹å‹•ãƒˆãƒªã‚¬ãƒ¼å¯èƒ½ãªã‚¿ã‚¹ã‚¯:**
- Feed API ãƒãƒ«ã‚¯åŒæœŸï¼ˆåˆå›åŒæœŸå‘ã‘ï¼‰
- ç‰¹å®šã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ã¿ã®åŒæœŸãƒ»åˆ†æ

---

## ğŸ“Š ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒ

### ä¸»è¦ãƒ†ãƒ¼ãƒ–ãƒ«

#### tenants
- ãƒ†ãƒŠãƒ³ãƒˆæƒ…å ±ï¼ˆãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆå¯¾å¿œï¼‰

#### oauth_credentials
- OAuth ãƒˆãƒ¼ã‚¯ãƒ³ï¼ˆAES-256-GCMæš—å·åŒ–ï¼‰
- **1ãƒ†ãƒŠãƒ³ãƒˆ : å¤šOAuthèªè¨¼æƒ…å ±**ï¼ˆãƒãƒ«ãƒã‚¢ã‚«ã‚¦ãƒ³ãƒˆå¯¾å¿œï¼‰

#### ebay_accounts
- eBayã‚¢ã‚«ã‚¦ãƒ³ãƒˆæƒ…å ±
- å„OAuthèªè¨¼æƒ…å ±ã«å¯¾å¿œï¼ˆ1å¯¾1ï¼‰

#### listings
- å‡ºå“ç‰©æƒ…å ±ï¼ˆitem_id, title, price, categoryç­‰ï¼‰

#### daily_metrics
- æ—¥æ¬¡ãƒ¡ãƒˆãƒªã‚¯ã‚¹ï¼ˆViewæ•°ã€Watchæ•°ã€ä¾¡æ ¼ï¼‰
- Unique constraint: (listing_id, recorded_date)

#### trend_analysis
- ãƒˆãƒ¬ãƒ³ãƒ‰åˆ†æçµæœ
- ãƒˆãƒ¬ãƒ³ãƒ‰ã‚¹ã‚³ã‚¢ã€æˆé•·ç‡ã€ãƒ©ãƒ³ã‚­ãƒ³ã‚°
- Unique constraint: (listing_id, analysis_date)

#### analytics_metrics
- Analytics APIãƒ¡ãƒˆãƒªã‚¯ã‚¹ï¼ˆCTRã€Impressionã€Conversion Rateï¼‰
- Unique constraint: (listing_id, recorded_date)

---

## âš ï¸ é‡è¦ãªå®Ÿè£…ä¸Šã®æ³¨æ„

### 1. eBay OAuthæ¥ç¶šã®è¨­å®šï¼ˆPhase 8ã§å®Œäº†ï¼‰

**ç¾åœ¨ã®çŠ¶æ…‹:**
- âœ… **OAuth 2.0ãƒ•ãƒ­ãƒ¼ãŒå®Œå…¨ã«å‹•ä½œ**
- âœ… **eBay Sandboxç’°å¢ƒã¨æ¥ç¶šæ¸ˆã¿**
- âœ… **ãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆå¯¾å¿œï¼ˆstateãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ãƒ†ãƒŠãƒ³ãƒˆIDç®¡ç†ï¼‰**
- âœ… **ãƒˆãƒ¼ã‚¯ãƒ³ã¯AES-256-GCMã§æš—å·åŒ–ã—ã¦ä¿å­˜**

**OAuthæ¥ç¶šã®è¨­å®šæ–¹æ³•:**

#### å¿…è¦ãªç’°å¢ƒå¤‰æ•°ï¼ˆ`.env`ï¼‰:
```bash
# eBay API Configuration
EBAY_CLIENT_ID=your_ebay_client_id_here  # App IDå½¢å¼
EBAY_CLIENT_SECRET=your_ebay_client_secret_here
EBAY_REDIRECT_URI=your_ebay_runame_here   # RuName
EBAY_ENVIRONMENT=sandbox  # ã¾ãŸã¯ production
EBAY_MOCK_MODE=false      # å®Ÿéš›ã®APIæ¥ç¶š
```

#### ngrokã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆé–‹ç™ºç’°å¢ƒã§HTTPSå¿…é ˆï¼‰:

1. **ngrokã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«** (Windows):
   - https://ngrok.com/download ã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
   - ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç™»éŒ²ã—ã¦authtokenã‚’å–å¾—

2. **ngrokã‚’èµ·å‹•**:
   ```bash
   ngrok http 8000
   ```

3. **eBay Developer Portalã§RuNameã‚’è¨­å®š**:
   - Redirect URL: `https://your-ngrok-url.ngrok-free.app/api/ebay-accounts/callback`
   - RuNameã‚’ã‚³ãƒ”ãƒ¼ã—ã¦`EBAY_REDIRECT_URI`ã«è¨­å®š

4. **Dockerã‚’å†èµ·å‹•**:
   ```bash
   docker-compose restart backend
   ```

#### OAuthæ¥ç¶šãƒ•ãƒ­ãƒ¼:
1. ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ã€ŒConnect eBay Accountã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
2. eBayãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ã§èªè¨¼
3. ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã§è‡ªå‹•çš„ã«ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä¿å­˜
4. ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«ã€ŒConnectedã€ãƒãƒƒãƒ—ãŒè¡¨ç¤ºã•ã‚Œã‚‹

**ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°:**
- ngrok URLãŒå¤‰æ›´ã•ã‚ŒãŸå ´åˆã€eBay RuNameã®Redirect URLã‚’æ›´æ–°
- `EBAY_REDIRECT_URI`ã«ã¯RuNameï¼ˆè­˜åˆ¥å­ï¼‰ã‚’è¨­å®šã€å®Œå…¨ãªURLã§ã¯ãªã„

---

### 2. ãƒ¢ãƒƒã‚¯ãƒ¢ãƒ¼ãƒ‰ã‹ã‚‰æœ¬ç•ªãƒ¢ãƒ¼ãƒ‰ã¸ã®ç§»è¡Œ

**ç¾åœ¨ã®çŠ¶æ…‹:**
- âœ… **OAuthæ¥ç¶šã¯å®Ÿéš›ã®eBay Sandboxã¨æ¥ç¶šæ¸ˆã¿**
- âš ï¸ **ãƒ‡ãƒ¼ã‚¿åŒæœŸAPIã¯ã¾ã ãƒ¢ãƒƒã‚¯ãƒ¢ãƒ¼ãƒ‰**ï¼ˆæ¬¡ãƒ•ã‚§ãƒ¼ã‚ºã§å®Ÿè£…äºˆå®šï¼‰
- `EBAY_MOCK_MODE=false` ã«è¨­å®šæ¸ˆã¿

**æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ï¼ˆPhase 9äºˆå®šï¼‰:**
1. âœ… OAuthæ¥ç¶šå®Œäº†ï¼ˆPhase 8ã§å®Œäº†ï¼‰
2. â¬œ **eBay User API**ã§å®Ÿéš›ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’å–å¾—
3. â¬œ **Trading API**ã§View/Watchæ•°ã‚’å–å¾—
4. â¬œ **Analytics API**ã§CTR/Impression/Conversion Rateã‚’å–å¾—
5. â¬œ **Feed API**ã§åˆå›åŒæœŸã‚’å®Ÿæ–½
6. â¬œ ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®ç¢ºèªï¼ˆãƒ¬ãƒ¼ãƒˆåˆ¶é™ã€ãƒˆãƒ¼ã‚¯ãƒ³å¤±åŠ¹ç­‰ï¼‰

### 3. eBay APIåˆ¶é™ã¸ã®å¯¾å¿œ

**æ¨™æº–ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®åˆ¶é™:**
- **1æ—¥5,000ã‚³ãƒ¼ãƒ«**ã¾ã§

**ä½¿ç”¨çŠ¶æ³:**
- Trading API: ç´„2,010ã‚³ãƒ¼ãƒ«/æ—¥ï¼ˆ2,000ä»¶ã®å•†å“ + ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ï¼‰
- Analytics API: ç´„40ã‚³ãƒ¼ãƒ«/æ—¥ï¼ˆ50ä»¶ãšã¤ãƒãƒƒãƒå‡¦ç†ï¼‰
- **åˆè¨ˆ: ç´„2,050ã‚³ãƒ¼ãƒ«/æ—¥**ï¼ˆåˆ¶é™å†…ï¼‰

**åˆ¶é™ã‚’è¶…ãˆã‚‹å ´åˆã®å¯¾ç­–:**
1. Redisã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°ï¼ˆåŒã˜æ—¥ã«2å›ä»¥ä¸Šå–å¾—ã—ãªã„ï¼‰
2. Feed APIã§ãƒãƒ«ã‚¯å–å¾—ï¼ˆ1ã‚¿ã‚¹ã‚¯ã§å…¨ä»¶å–å¾—ã€åˆå›ã®ã¿ï¼‰
3. eBayã«ç”³è«‹ã—ã¦ä¸Šé™ã‚’æ‹¡å¤§

### 4. ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ã¨ã‚¨ãƒ©ãƒ¼å‡¦ç†

**å®Ÿè£…æ¸ˆã¿ã®å¯¾ç­–:**

#### ã‚¼ãƒ­é™¤ç®—å¯¾ç­–
```python
def calculate_growth_rate(old_value: int, new_value: int) -> float:
    """æˆé•·ç‡è¨ˆç®—ï¼ˆã‚¼ãƒ­é™¤ç®—å¯¾ç­–ï¼‰"""
    if old_value == 0:
        return 100.0 if new_value > 0 else 0.0
    return ((new_value - old_value) / old_value) * 100
```

#### æ¬ æãƒ‡ãƒ¼ã‚¿å¯¾ç­–
```python
# å‰æ—¥ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ãŒãªã„å ´åˆ
if not yesterday_metrics:
    # ãƒˆãƒ¬ãƒ³ãƒ‰ã‚¹ã‚³ã‚¢ã¯0ã‚’è¿”ã™
    return 0.0
```

#### ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ç®¡ç†
```python
@celery.task
def sync_account_data(account_id):
    try:
        with db.begin():
            service.sync_listings(account_id)
    except Exception as e:
        logger.error(f"Sync failed: {e}")
        raise  # ãƒªãƒˆãƒ©ã‚¤æ©Ÿæ§‹ãŒå‹•ä½œ
```

### 5. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

**å®Ÿè£…æ¸ˆã¿:**
- âœ… ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ï¼ˆå…¨ä¸»è¦ãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰
- âœ… ãƒ¦ãƒ‹ãƒ¼ã‚¯åˆ¶ç´„ï¼ˆé‡è¤‡ãƒ‡ãƒ¼ã‚¿é˜²æ­¢ï¼‰
- âœ… Celeryãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã‚¸ãƒ§ãƒ–
- âœ… ãƒãƒƒãƒå‡¦ç†ï¼ˆAnalytics: 50ä»¶ãšã¤ï¼‰

**æ¨å¥¨äº‹é …:**
- N+1å•é¡Œã®å›é¿ï¼ˆjoinedloadä½¿ç”¨ï¼‰
- ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆå¤§é‡ãƒ‡ãƒ¼ã‚¿å–å¾—æ™‚ï¼‰
- Redisã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°ï¼ˆAPIãƒ¬ã‚¹ãƒãƒ³ã‚¹ï¼‰

**å®Ÿè£…ä¾‹:**
```python
# N+1å•é¡Œã®å›é¿
listings = db.query(Listing).options(
    joinedload(Listing.daily_metrics),
    joinedload(Listing.trend_analyses)
).filter(Listing.account_id == account_id).all()
```

---

## ğŸ” ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### æœ¬ç•ªç’°å¢ƒãƒ‡ãƒ—ãƒ­ã‚¤å‰

- [x] `.env`ãƒ•ã‚¡ã‚¤ãƒ«ãŒgitignoreã•ã‚Œã¦ã„ã‚‹
- [ ] SECRET_KEY ãŒå¼·åŠ›ãªãƒ©ãƒ³ãƒ€ãƒ æ–‡å­—åˆ—ï¼ˆ32æ–‡å­—ä»¥ä¸Šï¼‰
- [ ] ENCRYPTION_KEY ãŒé©åˆ‡ã«ç”Ÿæˆã•ã‚Œã¦ã„ã‚‹ï¼ˆbase64ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰32ãƒã‚¤ãƒˆï¼‰
- [ ] ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒå¼·åŠ›
- [ ] CORSè¨­å®šãŒæœ¬ç•ªãƒ‰ãƒ¡ã‚¤ãƒ³ã®ã¿è¨±å¯
- [ ] PostgreSQL Row Level Security (RLS) æœ‰åŠ¹åŒ–
- [ ] HTTPSä½¿ç”¨ï¼ˆæœ¬ç•ªç’°å¢ƒï¼‰
- [ ] eBayæœ¬ç•ªç’°å¢ƒã®èªè¨¼æƒ…å ±ä½¿ç”¨

### ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼é …ç›®

- [x] SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³å¯¾ç­–ï¼ˆORMãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‰ä½¿ç”¨ï¼‰
- [x] XSSå¯¾ç­–ï¼ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã§ã®ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ï¼‰
- [x] CSRFå¯¾ç­–ï¼ˆOAuth stateãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ¤œè¨¼æ¸ˆã¿ï¼‰
- [x] èªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³ã®é©åˆ‡ãªä¿å­˜ï¼ˆlocalStorageä½¿ç”¨ä¸­ï¼‰
- [x] ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¹³æ–‡ä¿å­˜ãªã—ï¼ˆbcryptä½¿ç”¨ä¸­ï¼‰
- [x] OAuth ãƒˆãƒ¼ã‚¯ãƒ³æš—å·åŒ–ï¼ˆAES-256-GCMä½¿ç”¨ä¸­ï¼‰
- [x] **ãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆå¯¾å¿œ**ï¼ˆstateãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ãƒ†ãƒŠãƒ³ãƒˆIDç®¡ç†ï¼‰
- [x] **OAuth stateãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®Base64ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰**ï¼ˆã‚»ã‚­ãƒ¥ã‚¢ãªé€ä¿¡ï¼‰

---

## ğŸ”„ ãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ•ãƒ­ãƒ¼

### Trading APIï¼ˆæ—¥æ¬¡æ›´æ–°ï¼‰
**ç”¨é€”**: åŸºæœ¬çš„ãªView/Watchæ•°ã®å–å¾—
- ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«: æ¯æ—¥åˆå‰2:00 UTC
- å–å¾—ãƒ‡ãƒ¼ã‚¿: Viewæ•°ã€Watchæ•°ã€ä¾¡æ ¼ã€åœ¨åº«æ•°
- åˆ¶é™: 2,000ä»¶/ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ

### Analytics APIï¼ˆæ—¥æ¬¡æ›´æ–°ï¼‰
**ç”¨é€”**: è©³ç´°ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯åˆ†æ
- ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«: æ¯æ—¥åˆå‰2:30 UTC
- å–å¾—ãƒ‡ãƒ¼ã‚¿: Click-Through Rateã€Impressionã€Conversion Rate
- ãƒãƒƒãƒå‡¦ç†: 50ä»¶ãšã¤

### Feed APIï¼ˆåˆå›åŒæœŸã®ã¿ï¼‰
**ç”¨é€”**: åˆå›ã®å¤§é‡ãƒ‡ãƒ¼ã‚¿ä¸€æ‹¬å–å¾—
- ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«: æ‰‹å‹•ãƒˆãƒªã‚¬ãƒ¼ã®ã¿
- å–å¾—ãƒ‡ãƒ¼ã‚¿: å…¨å‡ºå“ç‰©æƒ…å ±ï¼ˆ2,000ä»¶ä»¥ä¸Šå¯¾å¿œï¼‰
- åˆ©ç‚¹: Trading APIã®10-100å€é«˜é€Ÿ

---

## ğŸ› æ—¢çŸ¥ã®å•é¡Œã¨å¯¾å‡¦æ³•

### 1. bcryptè­¦å‘Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸

**å•é¡Œ:**
```
(trapped) error reading bcrypt version
AttributeError: module 'bcrypt' has no attribute '__about__'
```

**å¯¾å‡¦:**
- è­¦å‘Šã®ã¿ã§å‹•ä½œã«å½±éŸ¿ãªã—
- passlibãŒbcryptãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’èª­ã¿å–ã‚Œãªã„ã ã‘

### 2. Docker Composeè­¦å‘Š

**å•é¡Œ:**
```
the attribute `version` is obsolete
```

**å¯¾å‡¦:**
- Docker Compose v2ã®è­¦å‘Šï¼ˆå‹•ä½œã«å½±éŸ¿ãªã—ï¼‰

---

## ğŸš€ é–‹ç™ºå†é–‹æ™‚ã®ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

### ç’°å¢ƒã®èµ·å‹•

```bash
# ã™ã¹ã¦ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’èµ·å‹•
docker-compose up -d

# ãƒ­ã‚°ç¢ºèª
docker-compose logs -f backend

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³é©ç”¨
docker-compose exec backend alembic upgrade head
```

### ãƒ¢ãƒƒã‚¯ãƒ¢ãƒ¼ãƒ‰ã§ã®ãƒ†ã‚¹ãƒˆ

```bash
# .envãƒ•ã‚¡ã‚¤ãƒ«ã§ç¢ºèª
EBAY_MOCK_MODE=true

# ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰: http://localhost:3000
# ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²å¾Œã€ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«ã‚¢ã‚¯ã‚»ã‚¹

# ãƒ‡ãƒ¼ã‚¿åŒæœŸãƒ†ã‚¹ãƒˆï¼ˆãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆï¼‰
curl -X POST http://localhost:8000/api/sync/trigger \
  -H "Authorization: Bearer YOUR_TOKEN"

# ãƒˆãƒ¬ãƒ³ãƒ‰åˆ†æãƒ†ã‚¹ãƒˆ
curl -X POST http://localhost:8000/api/trends/analyze \
  -H "Authorization: Bearer YOUR_TOKEN"
```

### å®Ÿéš›ã®eBay APIæ¥ç¶šãƒ†ã‚¹ãƒˆï¼ˆPhase 8å®Œäº†ï¼‰

```bash
# .envã‚’æœ¬ç•ªãƒ¢ãƒ¼ãƒ‰ã«è¨­å®šï¼ˆæ—¢ã«è¨­å®šæ¸ˆã¿ï¼‰
EBAY_MOCK_MODE=false
EBAY_CLIENT_ID=your_ebay_client_id_here
EBAY_CLIENT_SECRET=your_ebay_client_secret_here
EBAY_REDIRECT_URI=your_ebay_runame_here

# ngrokã‚’èµ·å‹•ï¼ˆåˆ¥ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ï¼‰
ngrok http 8000

# ã‚³ãƒ³ãƒ†ãƒŠå†èµ·å‹•
docker-compose restart backend celery_worker celery_beat

# OAuthæ¥ç¶šãƒ†ã‚¹ãƒˆ
# 1. http://localhost:3000 ã§ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«ã‚¢ã‚¯ã‚»ã‚¹
# 2. ã€ŒConnect eBay Accountã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
# 3. eBayãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ã§èªè¨¼
# 4. ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«æˆ»ã‚Šã€ã€ŒConnectedã€ãƒãƒƒãƒ—ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
```

**ç¢ºèªæ–¹æ³•:**
```bash
# OAuthèªè¨¼æƒ…å ±ã‚’ç¢ºèª
docker-compose exec backend python -c "
from app.database import SessionLocal
from app.models.oauth_credential import OAuthCredential
db = SessionLocal()
cred = db.query(OAuthCredential).first()
if cred:
    print(f'âœ… OAuthèªè¨¼æƒ…å ±ãŒä¿å­˜ã•ã‚Œã¦ã„ã¾ã™')
    print(f'   æœ‰åŠ¹: {cred.is_valid}')
    print(f'   ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³æœŸé™: {cred.access_token_expires_at}')
else:
    print('âŒ OAuthèªè¨¼æƒ…å ±ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“')
"
```

---

## ğŸ“š å‚è€ƒãƒªã‚½ãƒ¼ã‚¹

### eBay API
- [eBay Developer Program](https://developer.ebay.com/)
- [Trading API Reference](https://developer.ebay.com/Devzone/XML/docs/Reference/eBay/index.html)
- [Analytics API](https://developer.ebay.com/api-docs/sell/analytics/overview.html)
- [Feed API](https://developer.ebay.com/api-docs/sell/feed/overview.html)
- [OAuth 2.0 Guide](https://developer.ebay.com/api-docs/static/oauth-tokens.html)

### æŠ€è¡“ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- [FastAPI](https://fastapi.tiangolo.com/)
- [Material-UI](https://mui.com/)
- [Recharts](https://recharts.org/)
- [Celery](https://docs.celeryq.dev/)
- [SQLAlchemy](https://www.sqlalchemy.org/)
- [Alembic](https://alembic.sqlalchemy.org/)
- [Redux Toolkit](https://redux-toolkit.js.org/)

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†…ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- `README.md` - ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã¨ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ
- `CLAUDE.md` - ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆé–‹ç™ºã‚¬ã‚¤ãƒ‰ï¼‰
- `PRODUCTION_SETUP.md` - æœ¬ç•ªç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰
- `.serena/memories/` - ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹æ§‹é€ ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

---

## ğŸ’¡ é–‹ç™ºã®ãƒ’ãƒ³ãƒˆ

### Claude Codeã§ã®åŠ¹ç‡çš„ãªé–‹ç™º

1. **æ®µéšçš„ãªå®Ÿè£…**
   - æ©Ÿèƒ½ã‚’å°ã•ãªã‚¿ã‚¹ã‚¯ã«åˆ†è§£
   - å„ã‚¿ã‚¹ã‚¯ã‚’å®Œäº†å¾Œã«ãƒ†ã‚¹ãƒˆ
   - å‹•ä½œç¢ºèªå¾Œã«ã‚³ãƒŸãƒƒãƒˆ

2. **ãƒ¢ãƒƒã‚¯æ´»ç”¨**
   - eBay APIãªã—ã§é–‹ç™ºç¶™ç¶šå¯èƒ½
   - ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã§å‹•ä½œç¢ºèª
   - æœ¬ç•ªAPIæ¥ç¶šã¯æœ€å¾Œ

3. **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**
   - ã‚¼ãƒ­é™¤ç®—ã€NULLå€¤ã€æ¬ æãƒ‡ãƒ¼ã‚¿ã‚’è€ƒæ…®
   - ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
   - ãƒ­ã‚°ã§è©³ç´°ã‚’è¨˜éŒ²

4. **ã‚³ãƒ¼ãƒ‰å“è³ª**
   - å‹ãƒ’ãƒ³ãƒˆå¿…é ˆï¼ˆPythonã€TypeScriptï¼‰
   - Docstringè¨˜è¿°
   - ä¸€è²«ã—ãŸã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¹ã‚¿ã‚¤ãƒ«

---

## ğŸ“± ãƒãƒ«ãƒã‚¢ã‚«ã‚¦ãƒ³ãƒˆæ©Ÿèƒ½ã®ä½¿ã„æ–¹

### ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®è¿½åŠ 

1. **æœ€åˆã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæ¥ç¶š**
   - ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ã€ŒConnect eBay Accountã€ã‚’ã‚¯ãƒªãƒƒã‚¯
   - eBayã§ãƒ­ã‚°ã‚¤ãƒ³ãƒ»èªè¨¼

2. **2ã¤ç›®ä»¥é™ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆè¿½åŠ **
   - ã€ŒAdd Another eBay Accountã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
   - **åˆ¥ã®eBayã‚¢ã‚«ã‚¦ãƒ³ãƒˆ**ã§ãƒ­ã‚°ã‚¤ãƒ³
   - â†’ ã‚¢ã‚«ã‚¦ãƒ³ãƒˆåˆ‡ã‚Šæ›¿ãˆã‚¿ãƒ–ã«è¿½åŠ ã•ã‚Œã‚‹

### ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®åˆ‡ã‚Šæ›¿ãˆ

ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ä¸Šéƒ¨ã«ã‚¿ãƒ–ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ï¼š
- **ã€ŒAll Accountsã€**: å…¨ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®çµ±åˆãƒ‡ãƒ¼ã‚¿
- **å„ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚¿ãƒ–**: ã‚¢ã‚«ã‚¦ãƒ³ãƒˆåˆ¥ãƒ‡ãƒ¼ã‚¿

ã‚¿ãƒ–ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€è¡¨ç¤ºãƒ‡ãƒ¼ã‚¿ãŒåˆ‡ã‚Šæ›¿ã‚ã‚Šã¾ã™ã€‚

### é‡è¦ãªæ³¨æ„ç‚¹

- âœ… **ç•°ãªã‚‹eBayã‚¢ã‚«ã‚¦ãƒ³ãƒˆ**ã§æ¥ç¶šã™ã‚‹ã“ã¨
- âŒ åŒã˜ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§å†æ¥ç¶š â†’ æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ãŒæ›´æ–°ã•ã‚Œã‚‹ã®ã¿
- âœ… å„ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¯ç‹¬ç«‹ã—ã¦ãƒãƒƒãƒå‡¦ç†ã•ã‚Œã‚‹
- âœ… å„ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒ‡ãƒ¼ã‚¿ã¯å®Œå…¨ã«åˆ†é›¢

---

## ğŸ¯ ä»Šå¾Œã®æ‹¡å¼µæ¡ˆï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

### 1. é€šçŸ¥æ©Ÿèƒ½
- ãƒˆãƒ¬ãƒ³ãƒ‰å•†å“æ¤œå‡ºæ™‚ã®ãƒ¡ãƒ¼ãƒ«/Slacké€šçŸ¥
- ã‚«ã‚¹ã‚¿ãƒ ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®š

### 2. ãƒ¬ãƒãƒ¼ãƒˆæ©Ÿèƒ½
- é€±æ¬¡ãƒ»æœˆæ¬¡ãƒ¬ãƒãƒ¼ãƒˆè‡ªå‹•ç”Ÿæˆ
- PDF/Excelã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ

### 3. ç«¶åˆåˆ†æ
- ç«¶åˆå•†å“ã®ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°
- ä¾¡æ ¼æ¯”è¼ƒæ©Ÿèƒ½

### 4. AIæ¨å¥¨æ©Ÿèƒ½
- æœ€é©ãªå‡ºå“ã‚¿ã‚¤ãƒŸãƒ³ã‚°ææ¡ˆ
- ä¾¡æ ¼æœ€é©åŒ–ã‚¢ãƒ‰ãƒã‚¤ã‚¹

---

## ğŸ¯ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ï¼ˆPhase 9: å®Ÿãƒ‡ãƒ¼ã‚¿åŒæœŸï¼‰

### å®Ÿè£…æ–¹é‡

**ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ**: Sandboxç’°å¢ƒã§å®Ÿãƒ‡ãƒ¼ã‚¿æ¥ç¶š â†’ Productionç§»è¡Œ

**ç†ç”±**:
- âœ… ãƒªã‚¹ã‚¯ç®¡ç†ï¼ˆæœ¬ç•ªãƒ‡ãƒ¼ã‚¿ã¸ã®å½±éŸ¿ãªã—ï¼‰
- âœ… é–‹ç™ºåŠ¹ç‡ï¼ˆå®Ÿéš›ã®APIå‹•ä½œã‚’å­¦ã¹ã‚‹ï¼‰
- âœ… æ®µéšçš„å®Ÿè£…ï¼ˆProductionã¯è¨­å®šå¤‰æ›´ã®ã¿ï¼‰

---

## Phase 9a: Sandboxç’°å¢ƒã§ã®å®Ÿãƒ‡ãƒ¼ã‚¿æ¥ç¶šï¼ˆæ¬¡ãƒ•ã‚§ãƒ¼ã‚ºï¼‰

ç¾åœ¨ã€OAuthæ¥ç¶šã¯å®Œäº†ã—ã¦ã„ã¾ã™ãŒã€ãƒ‡ãƒ¼ã‚¿åŒæœŸã¯**ã¾ã ãƒ¢ãƒƒã‚¯ãƒ¢ãƒ¼ãƒ‰**ã§ã™ã€‚

### å‰ææ¡ä»¶

**ç¾åœ¨ã®ç’°å¢ƒ**:
```bash
EBAY_ENVIRONMENT=sandbox
EBAY_MOCK_MODE=false  # â† ã“ã‚Œã§å®ŸAPIæ¥ç¶š
EBAY_CLIENT_ID=your_ebay_client_id_here
EBAY_CLIENT_SECRET=your_ebay_client_secret_here
```

**æ³¨æ„**: Sandboxç’°å¢ƒã«ã¯ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã—ã‹ãªã„ãŸã‚ã€Seller Hubã§äº‹å‰ã«ãƒ†ã‚¹ãƒˆå‡ºå“ç‰©ã‚’ä½œæˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

---

### Task 9a-1: eBay User APIçµ±åˆï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å–å¾—ï¼‰

**ç›®çš„**: OAuthæ¥ç¶šå¾Œã«å®Ÿéš›ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’å–å¾—ã—ã€`ebay_accounts`ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æ›´æ–°

**å®Ÿè£…å ´æ‰€**: `backend/app/services/ebay_user_service.py`ï¼ˆæ–°è¦ä½œæˆï¼‰

**å®Ÿè£…å†…å®¹**:
```python
class EbayUserService:
    """eBay User API service for fetching user information"""

    def __init__(self):
        self.environment = settings.EBAY_ENVIRONMENT
        self.api_url = "https://api.sandbox.ebay.com" if self.environment == "sandbox" \
                       else "https://api.ebay.com"

    def get_user_info(self, access_token: str) -> dict:
        """
        Fetch user information using access token

        API: GET /commerce/identity/v1/user/
        Returns: user_id, username, email, registration_marketplace_id
        """
        pass

    def update_ebay_account_info(
        self,
        db: Session,
        credential: OAuthCredential,
        user_info: dict
    ) -> EbayAccount:
        """
        Update ebay_accounts table with real user information

        Before: ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ (test_ebay_user_123, test_seller)
        After: å®Ÿãƒ‡ãƒ¼ã‚¿ (actual_user_id, actual_username)
        """
        pass
```

**APIä»•æ§˜**:
- **Endpoint**: `GET /commerce/identity/v1/user/`
- **Header**: `Authorization: Bearer {access_token}`
- **Response**:
```json
{
  "userId": "testuser123",
  "username": "test_seller",
  "email": "seller@example.com",
  "registrationMarketplaceId": "EBAY_US"
}
```

**ãƒˆãƒªã‚¬ãƒ¼ã‚¿ã‚¤ãƒŸãƒ³ã‚°**:
- OAuth callbackæˆåŠŸç›´å¾Œï¼ˆ`/api/ebay-accounts/callback`å†…ï¼‰
- æ—¢å­˜ã®OAuthæ¥ç¶šã«å¯¾ã—ã¦ã¯æ‰‹å‹•ãƒˆãƒªã‚¬ãƒ¼ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’ç”¨æ„

**æˆåŠŸåŸºæº–**:
- âœ… User APIã‹ã‚‰å®Ÿéš›ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’å–å¾—ã§ãã‚‹
- âœ… `ebay_accounts`ãƒ†ãƒ¼ãƒ–ãƒ«ãŒå®Ÿãƒ‡ãƒ¼ã‚¿ã§æ›´æ–°ã•ã‚Œã‚‹
- âœ… ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«å®Ÿéš›ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼åãŒè¡¨ç¤ºã•ã‚Œã‚‹

---

### Task 9a-2: Trading APIçµ±åˆï¼ˆå‡ºå“ç‰©ãƒ‡ãƒ¼ã‚¿åŒæœŸï¼‰

**ç›®çš„**: View/Watchæ•°ã‚’å«ã‚€å‡ºå“ç‰©ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—

**å®Ÿè£…å ´æ‰€**: `backend/app/services/ebay_trading_service.py`ï¼ˆãƒ¢ãƒƒã‚¯ã‹ã‚‰å®Ÿè£…ã«å¤‰æ›´ï¼‰

**å®Ÿè£…å†…å®¹**:
```python
class EbayTradingService:
    """eBay Trading API service for fetching listings data"""

    def sync_active_listings(self, credential: OAuthCredential) -> List[dict]:
        """
        Fetch active listings using Trading API

        API: GetMyeBaySelling
        Returns: List of listings with View/Watch counts
        """
        pass

    def parse_listing_data(self, xml_response: str) -> List[dict]:
        """
        Parse XML response from Trading API

        Extract: ItemID, Title, CurrentPrice, Quantity, ViewCount, WatchCount
        """
        pass

    def save_listings_and_metrics(
        self,
        db: Session,
        account: EbayAccount,
        listings_data: List[dict]
    ):
        """
        Save listings and daily metrics to database

        Tables: listings, daily_metrics
        """
        pass
```

**APIä»•æ§˜**:
- **Endpoint**: Trading API `GetMyeBaySelling`
- **Method**: XML-based SOAP API
- **Header**: `X-EBAY-API-IAF-TOKEN: {access_token}`
- **Request XML**:
```xml
<?xml version="1.0" encoding="utf-8"?>
<GetMyeBaySellingRequest xmlns="urn:ebay:apis:eBLBaseComponents">
  <ActiveList>
    <Include>true</Include>
    <Pagination>
      <EntriesPerPage>200</EntriesPerPage>
      <PageNumber>1</PageNumber>
    </Pagination>
  </ActiveList>
  <DetailLevel>ReturnAll</DetailLevel>
</GetMyeBaySellingRequest>
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ä¾‹**:
```xml
<Item>
  <ItemID>123456789</ItemID>
  <Title>Vintage Camera</Title>
  <SellingStatus>
    <CurrentPrice>99.99</CurrentPrice>
  </SellingStatus>
  <Quantity>1</Quantity>
  <HitCount>150</HitCount>  <!-- View count -->
  <WatchCount>5</WatchCount>
</Item>
```

**ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³**:
- 200ä»¶/ãƒšãƒ¼ã‚¸
- æœ€å¤§2,000ä»¶ã¾ã§å–å¾—
- 10ãƒšãƒ¼ã‚¸åˆ†ã®ãƒ«ãƒ¼ãƒ—å‡¦ç†

**æˆåŠŸåŸºæº–**:
- âœ… Trading APIã‹ã‚‰å®Ÿéš›ã®å‡ºå“ç‰©ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã§ãã‚‹
- âœ… `listings`ãƒ†ãƒ¼ãƒ–ãƒ«ã«ä¿å­˜ã•ã‚Œã‚‹
- âœ… `daily_metrics`ãƒ†ãƒ¼ãƒ–ãƒ«ã«View/Watchæ•°ãŒä¿å­˜ã•ã‚Œã‚‹
- âœ… ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«å®Ÿéš›ã®å‡ºå“ç‰©ãŒè¡¨ç¤ºã•ã‚Œã‚‹

---

### Task 9a-3: Analytics APIçµ±åˆï¼ˆãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ¡ãƒˆãƒªã‚¯ã‚¹ï¼‰

**ç›®çš„**: CTRã€Impressionã€Conversion Rateãªã©ã®è©³ç´°ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’å–å¾—

**å®Ÿè£…å ´æ‰€**: `backend/app/services/ebay_analytics_service.py`ï¼ˆãƒ¢ãƒƒã‚¯ã‹ã‚‰å®Ÿè£…ã«å¤‰æ›´ï¼‰

**å®Ÿè£…å†…å®¹**:
```python
class EbayAnalyticsService:
    """eBay Analytics API service"""

    def get_traffic_report(
        self,
        credential: OAuthCredential,
        listing_ids: List[str],
        date_range: str = "LAST_7_DAYS"
    ) -> dict:
        """
        Fetch traffic report for listings

        API: GET /sell/analytics/v1/traffic_report
        Returns: CTR, Impressions, Click counts
        """
        pass

    def save_analytics_metrics(
        self,
        db: Session,
        account: EbayAccount,
        analytics_data: dict
    ):
        """
        Save analytics metrics to database

        Table: analytics_metrics
        """
        pass
```

**APIä»•æ§˜**:
- **Endpoint**: `GET /sell/analytics/v1/traffic_report`
- **Query Parameters**:
  - `dimension=LISTING`
  - `filter=listingIds:{id1|id2|id3}`
  - `metric=CLICK_THROUGH_RATE,LISTING_IMPRESSION_TOTAL`
- **Header**: `Authorization: Bearer {access_token}`
- **ãƒãƒƒãƒã‚µã‚¤ã‚º**: 50ä»¶ãšã¤å‡¦ç†

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ä¾‹**:
```json
{
  "records": [
    {
      "listingId": "123456789",
      "clickThroughRate": "2.5",
      "listingImpressionTotal": "1000",
      "totalClickCount": "25"
    }
  ]
}
```

**æˆåŠŸåŸºæº–**:
- âœ… Analytics APIã‹ã‚‰å®Ÿéš›ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’å–å¾—ã§ãã‚‹
- âœ… `analytics_metrics`ãƒ†ãƒ¼ãƒ–ãƒ«ã«ä¿å­˜ã•ã‚Œã‚‹
- âœ… ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«CTR/ImpressionãŒè¡¨ç¤ºã•ã‚Œã‚‹

---

### Task 9a-4: ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚° & ãƒªãƒˆãƒ©ã‚¤æ©Ÿæ§‹

**ç›®çš„**: APIå‘¼ã³å‡ºã—å¤±æ•—æ™‚ã®é©åˆ‡ãªå‡¦ç†

**å®Ÿè£…å†…å®¹**:

#### ãƒ¬ãƒ¼ãƒˆåˆ¶é™å¯¾å¿œ
```python
class RateLimiter:
    """eBay API rate limiting handler"""

    def __init__(self, max_calls: int = 5000, period: int = 86400):
        self.max_calls = max_calls  # 1æ—¥5,000ã‚³ãƒ¼ãƒ«
        self.period = period  # 24æ™‚é–“

    def check_rate_limit(self, account_id: str) -> bool:
        """Check if API call is allowed"""
        pass

    def record_api_call(self, account_id: str):
        """Record API call in Redis"""
        pass
```

#### ãƒˆãƒ¼ã‚¯ãƒ³ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥
```python
class TokenRefresher:
    """OAuth token refresh handler"""

    def refresh_if_expired(self, credential: OAuthCredential) -> OAuthCredential:
        """
        Check token expiration and refresh if needed

        Access Token: 2æ™‚é–“æœ‰åŠ¹
        Refresh Token: 18ãƒ¶æœˆæœ‰åŠ¹
        """
        pass
```

#### ãƒªãƒˆãƒ©ã‚¤æ©Ÿæ§‹
```python
from tenacity import retry, stop_after_attempt, wait_exponential

@retry(
    stop=stop_after_attempt(3),
    wait=wait_exponential(multiplier=1, min=4, max=10)
)
def call_ebay_api_with_retry(url, headers, data):
    """Retry API call with exponential backoff"""
    pass
```

**ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**:
- `401 Unauthorized` â†’ ãƒˆãƒ¼ã‚¯ãƒ³ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥
- `429 Too Many Requests` â†’ ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã€å¾…æ©Ÿ
- `500 Server Error` â†’ ãƒªãƒˆãƒ©ã‚¤ï¼ˆæœ€å¤§3å›ï¼‰
- `404 Not Found` â†’ ã‚¹ã‚­ãƒƒãƒ—ã€ãƒ­ã‚°è¨˜éŒ²

**æˆåŠŸåŸºæº–**:
- âœ… ãƒˆãƒ¼ã‚¯ãƒ³æœŸé™åˆ‡ã‚Œæ™‚ã«è‡ªå‹•ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥
- âœ… ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã«é”ã—ãŸå ´åˆã¯ç¿Œæ—¥ã¾ã§å¾…æ©Ÿ
- âœ… ä¸€æ™‚çš„ãªã‚¨ãƒ©ãƒ¼ã¯è‡ªå‹•ãƒªãƒˆãƒ©ã‚¤

---

### Task 9a-5: Celery Beatã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«è¨­å®š

**ç›®çš„**: æ—¥æ¬¡è‡ªå‹•åŒæœŸã®å®Ÿè£…

**å®Ÿè£…å ´æ‰€**: `backend/app/celery_app.py`

**å®Ÿè£…å†…å®¹**:
```python
from celery.schedules import crontab

app.conf.beat_schedule = {
    'sync-trading-data': {
        'task': 'app.tasks.sync_tasks.sync_all_accounts_trading',
        'schedule': crontab(hour=2, minute=0),  # 02:00 UTC
    },
    'sync-analytics-data': {
        'task': 'app.tasks.sync_tasks.sync_all_accounts_analytics',
        'schedule': crontab(hour=2, minute=30),  # 02:30 UTC
    },
    'analyze-trends': {
        'task': 'app.tasks.trend_tasks.analyze_all_accounts_trends',
        'schedule': crontab(hour=3, minute=0),  # 03:00 UTC
    },
    'refresh-oauth-tokens': {
        'task': 'app.tasks.oauth_tasks.refresh_expiring_tokens',
        'schedule': crontab(minute=0),  # æ¯æ™‚
    },
}
```

**ã‚¿ã‚¹ã‚¯å®Ÿè£…**:
```python
@celery.task
def sync_all_accounts_trading():
    """Sync trading data for all connected accounts"""
    db = SessionLocal()
    try:
        # Get all accounts with valid OAuth credentials
        accounts = get_active_ebay_accounts(db)

        for account in accounts:
            sync_single_account_trading.delay(account.id)
    finally:
        db.close()

@celery.task(bind=True, max_retries=3)
def sync_single_account_trading(self, account_id: str):
    """Sync trading data for single account"""
    db = SessionLocal()
    try:
        account = db.query(EbayAccount).get(account_id)
        trading_service = EbayTradingService()

        # Fetch and save data
        listings_data = trading_service.sync_active_listings(account.credential)
        trading_service.save_listings_and_metrics(db, account, listings_data)

    except Exception as e:
        logger.error(f"Trading sync failed for account {account_id}: {e}")
        raise self.retry(exc=e, countdown=300)  # 5åˆ†å¾Œã«ãƒªãƒˆãƒ©ã‚¤
    finally:
        db.close()
```

**æˆåŠŸåŸºæº–**:
- âœ… Celery BeatãŒèµ·å‹•ã—ã€ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«é€šã‚Šã«ã‚¿ã‚¹ã‚¯ãŒå®Ÿè¡Œã•ã‚Œã‚‹
- âœ… å„ã‚¿ã‚¹ã‚¯ãŒã‚¨ãƒ©ãƒ¼ãªãå®Œäº†ã™ã‚‹
- âœ… ãƒ­ã‚°ã§å®Ÿè¡Œçµæœã‚’ç¢ºèªã§ãã‚‹

---

### Task 9a-6: æ‰‹å‹•ãƒˆãƒªã‚¬ãƒ¼ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

**ç›®çš„**: ãƒ†ã‚¹ãƒˆãƒ»ãƒ‡ãƒãƒƒã‚°ç”¨ã®æ‰‹å‹•åŒæœŸã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

**å®Ÿè£…å ´æ‰€**: `backend/app/api/sync.py`

**å®Ÿè£…å†…å®¹**:
```python
@router.post("/sync/user-info")
async def trigger_user_info_sync(
    current_tenant: Tenant = Depends(get_current_tenant),
    db: Session = Depends(get_db)
):
    """Manually trigger user info sync for current tenant"""
    pass

@router.post("/sync/trading")
async def trigger_trading_sync(
    current_tenant: Tenant = Depends(get_current_tenant),
    db: Session = Depends(get_db)
):
    """Manually trigger trading data sync"""
    pass

@router.post("/sync/analytics")
async def trigger_analytics_sync(
    current_tenant: Tenant = Depends(get_current_tenant),
    db: Session = Depends(get_db)
):
    """Manually trigger analytics data sync"""
    pass

@router.get("/sync/status")
async def get_sync_status(
    current_tenant: Tenant = Depends(get_current_tenant),
    db: Session = Depends(get_db)
):
    """Get last sync status and timestamps"""
    pass
```

**æˆåŠŸåŸºæº–**:
- âœ… å„ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‹ã‚‰æ‰‹å‹•ã§åŒæœŸã‚’ãƒˆãƒªã‚¬ãƒ¼ã§ãã‚‹
- âœ… åŒæœŸã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’ç¢ºèªã§ãã‚‹

---

## Phase 9b: ãƒ‡ãƒ¼ã‚¿åŒæœŸã®å®‰å®šåŒ–ï¼ˆPhase 9aå®Œäº†å¾Œï¼‰

### å®Ÿè£…å†…å®¹

1. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–**
   - ãƒãƒ«ã‚¯ã‚¯ã‚¨ãƒªã®æœ€é©åŒ–
   - N+1å•é¡Œã®è§£æ¶ˆ
   - Redisã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°

2. **ç›£è¦–ãƒ»ãƒ­ã‚°**
   - Celeryã‚¿ã‚¹ã‚¯ã®æˆåŠŸ/å¤±æ•—ç‡
   - APIå‘¼ã³å‡ºã—å›æ•°
   - åŒæœŸæ‰€è¦æ™‚é–“

3. **é€šçŸ¥æ©Ÿèƒ½**
   - åŒæœŸå¤±æ•—æ™‚ã®Slack/ãƒ¡ãƒ¼ãƒ«é€šçŸ¥
   - ãƒ¬ãƒ¼ãƒˆåˆ¶é™åˆ°é”æ™‚ã®ã‚¢ãƒ©ãƒ¼ãƒˆ

---

## Phase 10: Productionç’°å¢ƒã¸ã®ç§»è¡Œï¼ˆPhase 9bå®Œäº†å¾Œï¼‰

### å‰ææ¡ä»¶

1. **eBayæœ¬ç•ªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ä½œæˆ**
   - eBay Developer Portalã§æœ¬ç•ªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆ
   - Productionç”¨ã®Client ID/Secretã‚’å–å¾—
   - Productionç”¨ã®RuNameã‚’è¨­å®š

2. **æœ¬ç•ªç’°å¢ƒæº–å‚™**
   - å®Ÿéš›ã®ãƒ‰ãƒ¡ã‚¤ãƒ³å–å¾—
   - SSLè¨¼æ˜æ›¸è¨­å®š
   - æœ¬ç•ªãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ§‹ç¯‰

### ç’°å¢ƒå¤‰æ•°ã®å¤‰æ›´

```bash
# Productionè¨­å®š
EBAY_ENVIRONMENT=production  # â† å¤‰æ›´
EBAY_MOCK_MODE=false
EBAY_CLIENT_ID=your_production_client_id  # â† Productionç”¨
EBAY_CLIENT_SECRET=your_production_secret  # â† Productionç”¨
EBAY_REDIRECT_URI=your_production_runame  # â† Productionç”¨
```

### ç§»è¡Œæ‰‹é †

1. Sandboxç’°å¢ƒã§ååˆ†ãªãƒ†ã‚¹ãƒˆã‚’å®Ÿæ–½
2. Productionèªè¨¼æƒ…å ±ã‚’å–å¾—ãƒ»è¨­å®š
3. HTTPSç’°å¢ƒã‚’æ§‹ç¯‰ï¼ˆngrok â†’ å®Ÿéš›ã®SSLï¼‰
4. æ®µéšçš„ã«Productionã¸ç§»è¡Œï¼ˆã¾ãš1ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ãƒ†ã‚¹ãƒˆï¼‰
5. å…¨ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ç§»è¡Œ

---

## ğŸ“‹ Phase 9a å®Ÿè£…ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### Task 9a-1: User APIçµ±åˆ
- [ ] `EbayUserService`ã‚¯ãƒ©ã‚¹å®Ÿè£…
- [ ] User APIå‘¼ã³å‡ºã—å®Ÿè£…
- [ ] `ebay_accounts`ãƒ†ãƒ¼ãƒ–ãƒ«æ›´æ–°å‡¦ç†
- [ ] OAuth callbackå†…ã«çµ±åˆ
- [ ] æ‰‹å‹•ãƒˆãƒªã‚¬ãƒ¼ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆè¿½åŠ 
- [ ] å‹•ä½œç¢ºèªï¼ˆSandboxã§å®Ÿãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å–å¾—ï¼‰

### Task 9a-2: Trading APIçµ±åˆ
- [ ] `EbayTradingService`ä¿®æ­£ï¼ˆãƒ¢ãƒƒã‚¯â†’å®Ÿè£…ï¼‰
- [ ] XML APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå®Ÿè£…
- [ ] ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³å‡¦ç†
- [ ] `listings`ãƒ†ãƒ¼ãƒ–ãƒ«ä¿å­˜å‡¦ç†
- [ ] `daily_metrics`ãƒ†ãƒ¼ãƒ–ãƒ«ä¿å­˜å‡¦ç†
- [ ] å‹•ä½œç¢ºèªï¼ˆSandboxã§å‡ºå“ç‰©ãƒ‡ãƒ¼ã‚¿å–å¾—ï¼‰

### Task 9a-3: Analytics APIçµ±åˆ
- [ ] `EbayAnalyticsService`ä¿®æ­£ï¼ˆãƒ¢ãƒƒã‚¯â†’å®Ÿè£…ï¼‰
- [ ] ãƒãƒƒãƒå‡¦ç†å®Ÿè£…ï¼ˆ50ä»¶ãšã¤ï¼‰
- [ ] `analytics_metrics`ãƒ†ãƒ¼ãƒ–ãƒ«ä¿å­˜å‡¦ç†
- [ ] å‹•ä½œç¢ºèªï¼ˆSandboxã§ãƒ¡ãƒˆãƒªã‚¯ã‚¹å–å¾—ï¼‰

### Task 9a-4: ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- [ ] ãƒ¬ãƒ¼ãƒˆåˆ¶é™æ©Ÿæ§‹å®Ÿè£…ï¼ˆRedisï¼‰
- [ ] ãƒˆãƒ¼ã‚¯ãƒ³ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥æ©Ÿæ§‹
- [ ] ãƒªãƒˆãƒ©ã‚¤å‡¦ç†ï¼ˆtenacityï¼‰
- [ ] ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°è¨˜éŒ²
- [ ] å‹•ä½œç¢ºèªï¼ˆå„ç¨®ã‚¨ãƒ©ãƒ¼ã‚±ãƒ¼ã‚¹ï¼‰

### Task 9a-5: Celery Beatè¨­å®š
- [ ] ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«å®šç¾©
- [ ] å„ã‚¿ã‚¹ã‚¯å®Ÿè£…
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- [ ] ãƒ­ã‚°è¨˜éŒ²
- [ ] å‹•ä½œç¢ºèªï¼ˆã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«å®Ÿè¡Œï¼‰

### Task 9a-6: æ‰‹å‹•ãƒˆãƒªã‚¬ãƒ¼
- [ ] `/sync/user-info`ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
- [ ] `/sync/trading`ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
- [ ] `/sync/analytics`ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
- [ ] `/sync/status`ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
- [ ] å‹•ä½œç¢ºèªï¼ˆå„ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼‰

---

## ğŸ”§ é–‹ç™ºæ™‚ã®æ³¨æ„äº‹é …

### Sandboxãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®æº–å‚™

**é‡è¦**: Sandboxç’°å¢ƒã«ã¯å®Ÿéš›ã®å‡ºå“ç‰©ãŒãªã„ãŸã‚ã€äº‹å‰ã«ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

1. **Sandbox Seller Hubã«ã‚¢ã‚¯ã‚»ã‚¹**
   - https://sandbox.ebay.com/sh/ovw
   - Sandboxãƒ†ã‚¹ãƒˆã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ãƒ­ã‚°ã‚¤ãƒ³

2. **ãƒ†ã‚¹ãƒˆå‡ºå“ç‰©ã‚’ä½œæˆ**
   - æœ€ä½5-10ä»¶ã®å‡ºå“ç‰©ã‚’ä½œæˆ
   - ã‚¿ã‚¤ãƒˆãƒ«ã€ä¾¡æ ¼ã€ã‚«ãƒ†ã‚´ãƒªãƒ¼ã‚’è¨­å®š
   - View/Watchæ•°ã¯è‡ªå‹•çš„ã«ç”Ÿæˆã•ã‚Œã‚‹

3. **Trading APIã§ãƒ‡ãƒ¼ã‚¿ç¢ºèª**
   - GetMyeBaySellingã§å‡ºå“ç‰©ãŒå–å¾—ã§ãã‚‹ã“ã¨ã‚’ç¢ºèª

### ãƒ‡ãƒãƒƒã‚°æ–¹æ³•

```bash
# ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ­ã‚°ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–
docker-compose logs -f backend

# Celeryãƒ¯ãƒ¼ã‚«ãƒ¼ãƒ­ã‚°ç›£è¦–
docker-compose logs -f celery_worker

# Celery Beatãƒ­ã‚°ç›£è¦–
docker-compose logs -f celery_beat

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç¢ºèª
docker-compose exec backend python -c "
from app.database import SessionLocal
from app.models.listing import Listing
db = SessionLocal()
listings = db.query(Listing).all()
print(f'Listings count: {len(listings)}')
for listing in listings[:5]:
    print(f'  - {listing.item_id}: {listing.title}')
"
```

---

**Happy Coding! ğŸš€**

---

## âœ… å®Ÿè£…å®Œäº†ã‚µãƒãƒªãƒ¼

### Phase 1-8: å®Œäº† ğŸ‰

ã™ã¹ã¦ã®ä¸»è¦æ©Ÿèƒ½ãŒå®Ÿè£…ã•ã‚Œã€å®Ÿéš›ã®eBay APIã¨æ¥ç¶šå¯èƒ½ãªçŠ¶æ…‹ã§ã™ã€‚

**å®Œäº†ã—ãŸæ©Ÿèƒ½ï¼š**
- âœ… Dockerç’°å¢ƒæ§‹ç¯‰ï¼ˆPostgreSQL, Redis, FastAPI, React, Celeryï¼‰
- âœ… ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ã‚·ã‚¹ãƒ†ãƒ ï¼ˆJWT, bcryptï¼‰
- âœ… eBay OAuth 2.0ãƒ•ãƒ­ãƒ¼ï¼ˆãƒˆãƒ¼ã‚¯ãƒ³æš—å·åŒ–ï¼‰
- âœ… **ãƒãƒ«ãƒã‚¢ã‚«ã‚¦ãƒ³ãƒˆå¯¾å¿œ**ï¼ˆè¤‡æ•°eBayã‚¢ã‚«ã‚¦ãƒ³ãƒˆç®¡ç†ï¼‰
- âœ… ãƒ‡ãƒ¼ã‚¿åŒæœŸåŸºç›¤ï¼ˆãƒ¢ãƒƒã‚¯ãƒ¢ãƒ¼ãƒ‰å‹•ä½œç¢ºèªæ¸ˆã¿ï¼‰
- âœ… ãƒˆãƒ¬ãƒ³ãƒ‰åˆ†æã‚¨ãƒ³ã‚¸ãƒ³
- âœ… ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
- âœ… Celeryè‡ªå‹•ãƒãƒƒãƒã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«

### æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ï¼š

**Phase 9: å®Ÿãƒ‡ãƒ¼ã‚¿åŒæœŸã®å®Ÿè£…**
- eBay User APIçµ±åˆï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å–å¾—ï¼‰
- Trading APIçµ±åˆï¼ˆView/Watchæ•°å–å¾—ï¼‰
- Analytics APIçµ±åˆï¼ˆCTR/Conversionå–å¾—ï¼‰
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ï¼†ãƒªãƒˆãƒ©ã‚¤æ©Ÿæ§‹
- æœ¬ç•ªç’°å¢ƒã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤æº–å‚™

---

**Last Updated:** 2025-10-16
**Status:** Phase 8å®Œäº†ã€Phase 9æº–å‚™ä¸­
